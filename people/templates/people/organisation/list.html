{% extends 'base.html' %}

{% block content %}
    <nav aria-label="breadcrumb">
        <ol class="breadcrumb">
            <li class="breadcrumb-item active" aria-current="page">Organisation</li>
        </ol>
    </nav>

    <h1>Organisations</h1>

    <hr>

    <a class="btn btn-success"
        href="{% url 'people:organisation.create' %}">New Organisation</a>

    <table class="table table-borderless">
        {% regroup organisation_list.all by current_answers.hq_country as countries %}

        <tbody>
            {% for country in countries %}
                <tr><th>{{ country.grouper.name|default:"Unknown" }}</th></tr>

                {% for organisation in country.list %}
                    <tr>
                        <td>{{ organisation }}</td>
                        <td>
                            <a class="btn btn-sm btn-info"
                            href="{% url 'people:organisation.detail' pk=organisation.pk %}">Details</a>

                            {% if organisation.pk in existing_relationships %}
                                <a class="btn btn-sm btn-warning"
                                    style="width: 10rem"
                                    href="{% url 'people:organisation.relationship.create' organisation_pk=organisation.pk %}">Update Relationship
                                    </a>

                            {% else %}
                                <a class="btn btn-sm btn-success"
                                    style="width: 10rem"
                                    href="{% url 'people:organisation.relationship.create' organisation_pk=organisation.pk %}">New Relationship
                                    </a>
                            {% endif %}
                        </td>
                    </tr>
                {% endfor %}
            {% endfor %}
        </tbody>
    </table>

{% endblock %}
